(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     16897,        432]
NotebookOptionsPosition[     16488,        414]
NotebookOutlinePosition[     16825,        429]
CellTagsIndexPosition[     16782,        426]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"EPS", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MySign", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", ">", "EPS"}], ",", "1", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", "<", 
          RowBox[{"-", "EPS"}]}], ",", 
         RowBox[{"-", "1"}], ",", "0"}], "]"}]}], "]"}], ")"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LastColumn", " ", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ")"}], "&"}], "/@", 
      RowBox[{"Rest", "[", "x", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Trend", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"MySign", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rest", "[", 
         RowBox[{"LastColumn", "[", "#", "]"}], "]"}], "-", 
        RowBox[{"Most", "[", 
         RowBox[{"LastColumn", "[", "#", "]"}], "]"}]}], ")"}]}], ")"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListSum", " ", "=", " ", 
   RowBox[{"Function", "[", 
    RowBox[{"l", ",", "\[IndentingNewLine]", 
     RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"l", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"First", "[", "#2", "]"}], ",", 
            RowBox[{"First", "[", 
             RowBox[{"Dimensions", "[", "l", "]"}], "]"}]}], "}"}]}], "]"}], 
        "&"}], ",", "l"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ser", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListSum", "[", 
       RowBox[{
        RowBox[{"Trend", "[", "#1", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ";;", 
          RowBox[{"i", "+", "#2", "-", "1"}]}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"Dimensions", "[", 
           RowBox[{"Trend", "[", "#1", "]"}], "]"}], "]"}], "-", "#2"}]}], 
       "}"}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyImport", "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"\"\<Documents/IMEMO/eurusd/\>\"", "<>", "#"}], ",", " ", 
       "\"\<TSV\>\"", ",", " ", 
       RowBox[{"\"\<DateStringFormat\>\"", " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Year\>\"", ",", "\"\<-\>\"", ",", "\"\<Month\>\"", ",", 
          "\"\<-\>\"", ",", " ", "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", 
          "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", "\"\<:\>\"", ",", 
          "\"\<Second\>\""}], "}"}]}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColumnNames", " ", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FromCharacterCode", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"ToCharacterCode", "[", "\"\<a\>\"", "]"}], "]"}], "+", "i",
          "-", "1"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "#"}], "}"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColumnN", " ", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "#"}], "}"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cl1", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ">=", "1"}], ",", "\"\<m\>\"", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "\[LessEqual]", 
          RowBox[{"-", "1"}]}], ",", "\"\<l\>\"", ",", "\"\<e\>\""}], "]"}]}],
       "]"}], ")"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cl2", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", "\[GreaterEqual]", 
         RowBox[{"3", "-", "EPS"}]}], ",", "\"\<m\>\"", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", "\[GreaterEqual]", 
           RowBox[{"2", "-", "EPS"}]}], ",", "\"\<l\>\"", ",", "\"\<e\>\""}], 
         "]"}]}], "]"}], ")"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InClass", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", "s"}], "}"}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Most", "[", "#", "]"}], "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"Cl1", "[", "#", "]"}], "}"}]}], "&"}], ",", 
          RowBox[{"Ser", "[", 
           RowBox[{"l", ",", "s"}], "]"}]}], "]"}], ",", 
        RowBox[{"ColumnNames", "[", "s", "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1", " ", "=", 
   RowBox[{"InClass", "[", 
    RowBox[{
     RowBox[{"MyImport", "[", "\"\<EUR_USD.txt\>\"", "]"}], ",", " ", "S"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e2", " ", "=", 
    RowBox[{"InClass", "[", 
     RowBox[{
      RowBox[{"MyImport", "[", "\"\<EUR_USD2.txt\>\"", "]"}], ",", " ", "S"}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "weka`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadWeka", "[", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"e2", " ", "=", 
        RowBox[{"InClass", "[", 
         RowBox[{
          RowBox[{"MyImport", "[", "\"\<EUR_USD.txt\>\"", "]"}], ",", " ", 
          "S"}], "]"}]}], ";", 
       RowBox[{"e1", " ", "=", 
        RowBox[{"InClass", "[", 
         RowBox[{
          RowBox[{"MyImport", "[", "\"\<EUR_USD2.txt\>\"", "]"}], ",", " ", 
          "S"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"CreateWekaModel", "[", 
         RowBox[{"e1", ",", " ", 
          RowBox[{"Most", "[", 
           RowBox[{"ColumnN", "[", "S", "]"}], "]"}], ",", 
          RowBox[{"Last", "[", 
           RowBox[{"ColumnN", "[", "S", "]"}], "]"}], ",", 
          RowBox[{"WekaAlgorithm", "->", "\"\<MultilayerPerceptron\>\""}]}], 
         "]"}]}], ";", 
       RowBox[{"r2", " ", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Cl2", ",", 
          RowBox[{"RecallWekaModel", "[", 
           RowBox[{"e2", ",", "m1"}], "]"}]}], "]"}]}], ";", 
       RowBox[{"r2r", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"Rest", "[", "e2", "]"}]}], "]"}]}], ";", 
       RowBox[{"c", " ", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[NotEqual]", "#2"}], ",", "0", ",", "1"}], "]"}],
            "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"r2", ",", "r2r"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"S", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"Total", "[", "c", "]"}], "/", 
           RowBox[{"First", "[", 
            RowBox[{"Dimensions", "[", "c", "]"}], "]"}]}], "]"}]}], "}"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"S", ",", "3", ",", "17"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "R", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.42626355397046*^9, 3.426263610382576*^9}, {
   3.426263660398263*^9, 3.426263675127018*^9}, {3.4262637123706493`*^9, 
   3.426263739449588*^9}, {3.426263783647853*^9, 3.4262638524631023`*^9}, {
   3.426263913870716*^9, 3.426263969747464*^9}, {3.42626424727295*^9, 
   3.426264288421878*^9}, {3.4262643189982653`*^9, 3.426264439462789*^9}, {
   3.42626452129978*^9, 3.426264650175564*^9}, {3.4262646907584*^9, 
   3.4262647063649178`*^9}, {3.426264744845601*^9, 3.4262648047621717`*^9}, {
   3.426264849195945*^9, 3.426264979108779*^9}, {3.4262651345318747`*^9, 
   3.426265222121255*^9}, {3.426265412334261*^9, 3.426265700758287*^9}, {
   3.426265749640884*^9, 3.4262659478163233`*^9}, {3.4262660653432817`*^9, 
   3.426266101894161*^9}, {3.426266337216474*^9, 3.4262663592964582`*^9}, {
   3.426266421237722*^9, 3.426266729587274*^9}, {3.426266760435772*^9, 
   3.4262668429685583`*^9}, {3.426266924744424*^9, 3.4262669947809057`*^9}, {
   3.426267033534802*^9, 3.426267058800496*^9}, {3.426267099456025*^9, 
   3.426267477440881*^9}, {3.426267507551301*^9, 3.426267603400504*^9}, {
   3.4262677158822727`*^9, 3.426267882109527*^9}, {3.426267920398988*^9, 
   3.426268087339056*^9}, {3.4262681327473297`*^9, 3.426268132836719*^9}, {
   3.426268227524135*^9, 3.426268240719635*^9}, {3.426268583661078*^9, 
   3.4262686650281763`*^9}, {3.4262688191159077`*^9, 
   3.4262688211531563`*^9}, {3.426268886673564*^9, 3.426268888261681*^9}, {
   3.4262690690965853`*^9, 3.426269176891755*^9}, {3.4262692923500967`*^9, 
   3.426269292468069*^9}, {3.42626941895575*^9, 3.426269420152227*^9}, {
   3.426269468121826*^9, 3.42626946837211*^9}, {3.426269498811514*^9, 
   3.4262695672781076`*^9}, {3.4262697112682867`*^9, 3.426269872752083*^9}, 
   3.426269939125424*^9, {3.4262699980789843`*^9, 3.42627000263731*^9}, {
   3.4262700355045023`*^9, 3.4262701780233383`*^9}, 3.426270215231666*^9, {
   3.426270253608539*^9, 3.426270294247891*^9}, {3.426270340717578*^9, 
   3.4262704256152*^9}, {3.426270456567506*^9, 3.426270494546266*^9}, {
   3.426270534068296*^9, 3.4262705795463533`*^9}, {3.426270651497772*^9, 
   3.426270654246571*^9}, {3.4262707000413103`*^9, 3.426270732490011*^9}, {
   3.426270781129487*^9, 3.4262708009772863`*^9}, {3.426270843624591*^9, 
   3.4262708632793694`*^9}, {3.4262709168037443`*^9, 3.426270918547926*^9}, {
   3.426270990642569*^9, 3.426271106892774*^9}, {3.426271179019833*^9, 
   3.4262714399703293`*^9}, {3.426272201434753*^9, 3.426272219047929*^9}, {
   3.426272285997239*^9, 3.426272304116803*^9}, {3.4262723506703453`*^9, 
   3.426272353006939*^9}, {3.426272495071035*^9, 3.426272505394763*^9}, {
   3.426272583137144*^9, 3.426272687100274*^9}, {3.426272875524404*^9, 
   3.426272875732728*^9}, {3.426272965226735*^9, 3.4262729748951273`*^9}, {
   3.4262730682930613`*^9, 3.426273068465438*^9}, {3.426273138400558*^9, 
   3.426273142498624*^9}, {3.426273215593232*^9, 3.426273216639401*^9}, {
   3.426273265727954*^9, 3.4262732778013983`*^9}, {3.426273329582115*^9, 
   3.426273334406911*^9}, {3.426273378328251*^9, 3.426273390753743*^9}, {
   3.426273450875795*^9, 3.4262734557753696`*^9}, {3.42627351793044*^9, 
   3.42627352393913*^9}, {3.426317250648926*^9, 3.426317320180764*^9}, {
   3.426317363570097*^9, 3.426317448963374*^9}, {3.42631749944*^9, 
   3.4263176518544073`*^9}, {3.42631769667911*^9, 3.426317916834794*^9}, {
   3.42631811282976*^9, 3.426318122971895*^9}, {3.426318405039455*^9, 
   3.426318474080481*^9}, {3.426319215709196*^9, 3.4263192162059*^9}, {
   3.426319629051112*^9, 3.4263196450095*^9}, {3.426319694443698*^9, 
   3.4263196983635197`*^9}, {3.426321594310793*^9, 3.426321603939129*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{3., 0.42567567567567566`}, {4., 0.4271186440677966}, {5., 
     0.42857142857142855`}, {6., 0.45051194539249145`}, {7., 
     0.476027397260274}, {8., 0.5292096219931272}, {9., 0.5448275862068965}, {
     10., 0.47058823529411764`}, {11., 0.4722222222222222}, {12., 
     0.4878048780487805}, {13., 0.4405594405594406}, {14., 
     0.45964912280701753`}, {15., 0.4225352112676056}, {16., 
     0.508833922261484}, {17., 0.4432624113475177}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{4., 0.42},
  PlotRange->{{3., 17.}, {0.4225352112676056, 0.5448275862068965}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.426321988426545*^9}]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  GraphicsBox[{{}, 
    {Hue[0.67, 0.6, 0.6], 
     PointBox[{{3., 0.48986486486486486`}, {4., 0.5084745762711864}, {5., 
      0.5068027210884354}, {6., 0.5255972696245734}, {7., 
      0.5205479452054794}, {8., 0.5498281786941581}, {9., 
      0.5413793103448276}, {10., 0.5605536332179931}, {11., 
      0.5034722222222222}, {12., 0.5400696864111498}, {13., 
      0.493006993006993}, {14., 0.519298245614035}, {15., 
      0.5140845070422535}}]}, {}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   AxesOrigin->{4., 0.49},
   PlotRange->{{3., 15.}, {0.48986486486486486`, 0.5605536332179931}},
   PlotRangeClipping->True,
   PlotRangePadding->{
     Scaled[0.02], 
     Scaled[0.02]}], "DisplayFormula"]], "Input",
 CellChangeTimes->{
  3.4262732322141333`*^9, 3.426273296829646*^9, 3.426273353603022*^9, 
   3.426273420209346*^9, 3.426273489807549*^9, {3.4263176077833443`*^9, 
   3.426317768970598*^9}, 3.426319090245639*^9, 3.426319443528123*^9, 
   3.4263199851778107`*^9, {3.426323971229188*^9, 3.426323972876299*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   StyleBox[
    GraphicsBox[{{}, 
      {Hue[0.67, 0.6, 0.6], 
       PointBox[{{3., 0.48986486486486486`}, {4., 0.5084745762711864}, {5., 
        0.5068027210884354}, {6., 0.5255972696245734}, {7., 
        0.5205479452054794}, {8., 0.5498281786941581}, {9., 
        0.5413793103448276}, {10., 0.5605536332179931}, {11., 
        0.5034722222222222}, {12., 0.5400696864111498}, {13., 
        0.493006993006993}, {14., 0.519298245614035}, {15., 
        0.5140845070422535}}]}, {}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesOrigin->{4., 0.49},
     ImageSize->{204., Automatic},
     PlotRange->{{3., 15.}, {0.48986486486486486`, 0.5605536332179931}},
     PlotRangeClipping->True,
     PlotRangePadding->{
       Scaled[0.02], 
       Scaled[0.02]}], "DisplayFormula"], 
   GraphicsBox[{{}, 
     {Hue[0.67, 0.6, 0.6], 
      PointBox[{{3., 0.42567567567567566`}, {4., 0.4271186440677966}, {5., 
       0.42857142857142855`}, {6., 0.45051194539249145`}, {7., 
       0.476027397260274}, {8., 0.5292096219931272}, {9., 
       0.5448275862068965}, {10., 0.47058823529411764`}, {11., 
       0.4722222222222222}, {12., 0.4878048780487805}, {13., 
       0.4405594405594406}, {14., 0.45964912280701753`}, {15., 
       0.4225352112676056}, {16., 0.508833922261484}, {17., 
       0.4432624113475177}}]}, {}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{4., 0.42},
    ImageSize->{209., Automatic},
    PlotRange->{{3., 17.}, {0.4225352112676056, 0.5448275862068965}},
    PlotRangeClipping->True,
    PlotRangePadding->{
      Scaled[0.02], 
      Scaled[0.02]}]}]}]], "Input",
 CellChangeTimes->{{3.426320102389348*^9, 3.42632010269023*^9}, 
   3.4263239746838408`*^9}]
},
WindowSize->{828, 661},
WindowMargins->{{209, Automatic}, {Automatic, 0}},
FrontEndVersion->"6.0 for Mac OS X x86 (32-bit) (April 20, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 12125, 299, 568, "Input"],
Cell[12718, 324, 832, 18, 252, "Output"]
}, Open  ]],
Cell[13565, 345, 1085, 23, 247, "Input"],
Cell[14653, 370, 1831, 42, 184, "Input"]
}
]
*)

(* End of internal cache information *)
